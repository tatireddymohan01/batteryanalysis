# Project Configuration
project:
  name: "Battery Degradation Prediction"
  version: "1.0.0"
  description: "ML model to predict battery SOH degradation"

# Data Generation Settings
data_generation:
  n_samples: 10000
  test_size: 0.2
  validation_size: 0.1
  random_state: 42
  
  # Feature ranges
  features:
    cycles:
      min: 0
      max: 2000
      distribution: "uniform"
    temperature:
      min: -10
      max: 60
      mean: 25
      std: 15
    c_rate:
      min: 0.1
      max: 3.0
      distribution: "normal"
      mean: 1.0
      std: 0.5
    voltage_min:
      value: 3.0
      noise: 0.1
    voltage_max:
      value: 4.2
      noise: 0.1
    usage_hours:
      correlation_with_cycles: 0.9
      base_hours_per_cycle: 2.5
      noise: 0.3
    humidity:
      min: 20
      max: 90
      mean: 50
      std: 20
      
  # Degradation model parameters
  degradation:
    base_degradation_rate: 0.02  # % per 100 cycles
    temperature_coefficient: 0.002  # Additional degradation per °C above 25°C
    c_rate_coefficient: 0.01  # Additional degradation per C-rate unit
    voltage_stress_coefficient: 0.005
    humidity_coefficient: 0.0005

# Preprocessing Settings
preprocessing:
  handle_missing: "drop"  # or "impute"
  outlier_method: "iqr"  # or "zscore", "isolation_forest"
  outlier_threshold: 3.0
  
  scaling:
    method: "standard"  # or "minmax", "robust"
    features_to_scale:
      - cycles
      - temperature
      - c_rate
      - voltage_min
      - voltage_max
      - usage_hours
      - humidity

# Feature Engineering
feature_engineering:
  create_polynomial_features: true
  polynomial_degree: 2
  interaction_features: true
  
  derived_features:
    - cycle_rate  # cycles per usage hour
    - temperature_stress  # (temp - 25) * cycles
    - voltage_range  # voltage_max - voltage_min
    - c_rate_stress  # c_rate * cycles
    - cumulative_stress  # combined stress indicator
    - temperature_humidity_interaction

# Model Training
models:
  linear_regression:
    enabled: true
    params: {}
    
  ridge_regression:
    enabled: true
    params:
      alpha: [0.1, 1.0, 10.0, 100.0]
      
  random_forest:
    enabled: true
    params:
      n_estimators: [100, 200, 300]
      max_depth: [10, 20, 30, null]
      min_samples_split: [2, 5, 10]
      min_samples_leaf: [1, 2, 4]
      
  xgboost:
    enabled: true
    params:
      n_estimators: [100, 200, 300]
      learning_rate: [0.01, 0.05, 0.1]
      max_depth: [3, 5, 7]
      subsample: [0.8, 0.9, 1.0]
      colsample_bytree: [0.8, 0.9, 1.0]
      
  lightgbm:
    enabled: true
    params:
      n_estimators: [100, 200]
      learning_rate: [0.01, 0.05, 0.1]
      max_depth: [3, 5, 7]
      num_leaves: [31, 50, 70]

# Hyperparameter Tuning
hyperparameter_tuning:
  method: "optuna"  # or "grid_search", "random_search"
  n_trials: 50  # for optuna
  cv_folds: 5
  scoring: "neg_root_mean_squared_error"
  n_jobs: -1

# Model Evaluation
evaluation:
  metrics:
    - rmse
    - mae
    - r2
    - mape
    - max_error
  
  cross_validation:
    n_splits: 5
    shuffle: false  # Time series nature
    
  feature_importance:
    method: "shap"  # or "permutation", "built_in"

# MLflow Tracking
mlflow:
  tracking_uri: "./models/experiments"
  experiment_name: "battery_degradation"
  artifact_location: "./models/experiments/artifacts"
  
  log_params: true
  log_metrics: true
  log_artifacts: true
  log_models: true

# API Settings
api:
  host: "0.0.0.0"
  port: 8000
  reload: false
  workers: 4
  
  model_path: "./models/saved/best_model.pkl"
  scaler_path: "./models/saved/scaler.pkl"
  
  validation:
    cycles_min: 0
    cycles_max: 5000
    temperature_min: -20
    temperature_max: 80
    c_rate_min: 0.05
    c_rate_max: 5.0
    voltage_min_range: [2.5, 3.5]
    voltage_max_range: [3.8, 4.5]
    usage_hours_min: 0
    usage_hours_max: 50000
    humidity_min: 0
    humidity_max: 100

# Azure ML Configuration
azure:
  subscription_id: "your-subscription-id"
  resource_group: "battery-ml-rg"
  workspace_name: "battery-ml-workspace"
  
  compute:
    name: "cpu-cluster"
    vm_size: "STANDARD_DS3_V2"
    min_nodes: 0
    max_nodes: 4
    
  deployment:
    endpoint_name: "battery-prediction-endpoint"
    deployment_name: "battery-prediction-v1"
    instance_type: "Standard_DS2_v2"
    instance_count: 1
    
  model_registry:
    model_name: "battery_soh_predictor"
    model_version: "1"

# Logging
logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  log_file: "./logs/app.log"
  max_bytes: 10485760  # 10MB
  backup_count: 5
